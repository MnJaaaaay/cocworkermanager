<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â∑•‰∫∫ÁÆ°ÁêÜÁ≥ªÁªü</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f6fa;
            color: #2c3e50;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }

        .header-info {
            flex: 1;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .version-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 10px;
        }

        .version-badge {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .author-info {
            font-style: italic;
        }

        .import-export-section {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .file-input {
            display: none;
        }

        .btn-import {
            background: #27ae60;
        }

        .btn-import:hover {
            background: #229954;
        }

        .btn-export {
            background: #e67e22;
        }

        .btn-export:hover {
            background: #d35400;
        }

        .header h1 {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .header .time {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #2980b9;
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
        }

        .btn-mini {
            padding: 3px 6px;
            font-size: 10px;
        }

        .btn-danger {
            background: #e74c3c;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-secondary {
            background: #95a5a6;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .summary {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .summary h2 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        /* Ë¥¶Âè∑Ê±áÊÄªÁÆÄÁ∫¶Ê†∑Âºè */
        .summary-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
        }

        .summary-card.available {
            background: linear-gradient(135deg, #d5f4e6 0%, #a8e6cf 100%);
            border-color: #27ae60;
            color: #1e7e34;
        }

        .summary-card.busy {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border-color: #e74c3c;
            color: #c62828;
        }

        .summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .summary-card h3 {
            font-size: 1.2em;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            font-weight: bold;
        }

        .account-status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .account-status-dot.available {
            background: #27ae60;
        }

        .account-status-dot.busy {
            background: #e74c3c;
        }

        .upcoming-tasks {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
        }

        .upcoming-tasks h4 {
            font-size: 0.85em;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .task-item {
            background: white;
            border-radius: 4px;
            padding: 8px;
            margin-bottom: 6px;
            font-size: 0.8em;
            border-left: 3px solid #3498db;
        }

        .task-item:last-child {
            margin-bottom: 0;
        }

        .task-item.worker-task {
            border-left-color: #3498db;
        }

        .task-item.scholar-task {
            border-left-color: #9b59b6;
        }

        .task-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .task-time {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        /* ÂÖ®Â±ÄÂç≥Â∞ÜÂÆåÊàê‰ªªÂä° - ÂÆûÊó∂Âä®ÊÄÅ */
        .global-upcoming {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 20px;
        }

        .global-upcoming h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .realtime-indicator {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .task-progress-table {
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
        }

        .task-progress-header {
            background: #34495e;
            color: white;
            padding: 12px 20px;
            font-weight: 600;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            align-items: center;
            font-size: 0.9em;
        }

        .task-progress-row {
            padding: 12px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            align-items: center;
            transition: background 0.3s ease;
            cursor: pointer;
        }

        .task-progress-row:hover {
            background: #f0f0f0;
        }

        .task-progress-row:last-child {
            border-bottom: none;
        }

        /* Á©∫Èó≤Â∑•‰∫∫/Â≠¶ÂæíÈ´ò‰∫ÆÊ†∑Âºè */
        .task-progress-row.available-highlight {
            background: linear-gradient(135deg, #d5f4e6 0%, #a8e6cf 100%);
            border-left: 4px solid #27ae60;
            font-weight: bold;
            animation: glow 3s ease-in-out infinite alternate;
        }

        .task-progress-row.available-highlight:hover {
            background: linear-gradient(135deg, #c8f2dc 0%, #9de0c1 100%);
        }

        @keyframes glow {
            from { box-shadow: 0 0 5px rgba(39, 174, 96, 0.3); }
            to { box-shadow: 0 0 15px rgba(39, 174, 96, 0.6); }
        }

        /* Âç≥Â∞ÜÂÆåÊàê‰ªªÂä°Ê†∑Âºè */
        .task-progress-row.completing-task {
            background: #fff9e6;
            border-left: 4px solid #f39c12;
        }

        .task-progress-row.completing-task:hover {
            background: #fff3d4;
        }

        .task-account {
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.9em;
        }

        .task-worker {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .task-worker.worker-type {
            color: #3498db;
        }

        .task-worker.scholar-type {
            color: #9b59b6;
        }

        /* Á©∫Èó≤Áä∂ÊÄÅÁâπÊÆäÊ†∑Âºè */
        .task-worker.available-worker {
            color: #27ae60;
            font-weight: bold;
        }

        .task-worker.available-scholar {
            color: #8e44ad;
            font-weight: bold;
        }

        .task-name-cell {
            color: #2c3e50;
            font-size: 0.9em;
        }

        .task-name-cell.available-status {
            color: #27ae60;
            font-weight: bold;
            font-style: italic;
        }

        .task-time-cell {
            font-weight: bold;
            font-size: 0.9em;
        }

        .task-time-cell.urgent {
            color: #e74c3c;
        }

        .task-time-cell.warning {
            color: #f39c12;
        }

        .task-time-cell.normal {
            color: #27ae60;
        }

        .task-time-cell.available {
            color: #27ae60;
            font-weight: bold;
        }

        .release-cell {
            text-align: center;
        }

        .assign-task-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: background 0.3s;
            min-width: 40px;
        }

        .assign-task-btn:hover {
            background: #229954;
        }

        .quick-release-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: background 0.3s;
            min-width: 40px;
        }

        .quick-release-btn:hover {
            background: #c0392b;
        }

        .quick-release-btn.urgent {
            background: #e74c3c;
        }

        .quick-release-btn.urgent:hover {
            background: #c0392b;
        }

        .quick-release-btn.warning {
            background: #f39c12;
        }

        .quick-release-btn.warning:hover {
            background: #e67e22;
        }

        .quick-release-btn.normal {
            background: #27ae60;
        }

        .quick-release-btn.normal:hover {
            background: #229954;
        }

        .no-tasks-message {
            text-align: center;
            color: #95a5a6;
            padding: 30px;
            font-style: italic;
        }

        /* Â∑•‰∫∫ËøõÂ∫¶Êù° */
        .worker-progress {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            margin: 8px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .progress-bar.green {
            background: linear-gradient(to right, #27ae60, #2ecc71);
        }

        .progress-bar.orange {
            background: linear-gradient(to right, #f39c12, #e67e22);
        }

        .progress-bar.red {
            background: linear-gradient(to right, #e74c3c, #c0392b);
        }

        /* Ë¥¶Âè∑ËØ¶ÊÉÖÂ±ïÂºÄ/ÊäòÂè† */
        .account-detail {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .account-detail.collapsed {
            display: none;
        }

        .account-detail-header {
            background: #34495e;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .account-detail-header:hover {
            background: #2c3e50;
        }

        .account-detail-title {
            font-size: 1.1em;
            font-weight: bold;
        }

        .account-detail-content {
            padding: 20px;
        }

        /* ÊîæÂÅáÁä∂ÊÄÅ */
        .worker-card.vacation {
            background: #f8f9fa;
            border-color: #95a5a6;
            opacity: 0.7;
        }

        .worker-card.vacation .worker-name {
            color: #95a5a6;
        }

        .vacation-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
        }

        .vacation-btn:hover {
            background: #7f8c8d;
        }

        .work-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
        }

        .work-btn:hover {
            background: #229954;
        }

        .edit-controls {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .summary-card:hover .edit-controls {
            opacity: 1;
        }

        .edit-input {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px 8px;
            font-size: 1em;
            flex: 1;
        }

        .accounts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }

        .account-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .account-title {
            font-size: 1.3em;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .workers-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .workers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .worker-card {
            border: 2px solid;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .worker-card.available {
            background: #d5f4e6;
            border-color: #27ae60;
        }

        .worker-card.working {
            background: #ffebee;
            border-color: #e74c3c;
        }

        .worker-card .worker-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .worker-name {
            font-weight: bold;
            font-size: 0.9em;
        }

        .worker-card.available .worker-name {
            color: #27ae60;
        }

        .worker-card.working .worker-name {
            color: #e74c3c;
        }

        .worker-info {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .worker-task {
            margin-top: 5px;
            font-size: 0.8em;
        }

        .release-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
        }

        .modal h3 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .form-actions .btn {
            flex: 1;
        }

        .icon {
            width: 16px;
            height: 16px;
            display: inline-block;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header-top {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .header-info {
                text-align: center;
            }

            .header-info h1 {
                font-size: 1.6em;
                line-height: 1.3;
                margin-bottom: 8px;
            }

            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
                gap: 8px;
            }

            .btn {
                padding: 8px 12px;
                font-size: 0.9em;
                white-space: nowrap;
            }

            .version-info {
                flex-direction: column;
                align-items: center;
                gap: 6px;
                text-align: center;
                font-size: 0.85em;
                line-height: 1.4;
            }

            .version-badge {
                font-size: 0.75em;
                padding: 3px 6px;
            }

            .summary-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .summary-card {
                padding: 12px;
                min-height: auto;
            }

            .summary-card h3 {
                font-size: 1.1em;
                margin: 0;
            }

            .account-simple-actions {
                gap: 8px;
            }

            .task-btn {
                font-size: 0.85em;
                padding: 10px 12px;
            }

            .global-upcoming {
                padding: 15px;
                margin-bottom: 15px;
            }

            .task-progress-header,
            .task-progress-row {
                grid-template-columns: 1fr auto;
                gap: 8px;
                font-size: 0.75em;
                padding: 8px 10px;
            }

            .assign-task-btn,
            .quick-release-btn {
                font-size: 0.7em;
                padding: 4px 6px;
                min-width: 60px;
            }

            .modal-content {
                width: 95%;
                max-width: 350px;
                padding: 20px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ê†áÈ¢òÊ†è -->
        <div class="header">
            <div class="header-top">
                <div class="header-info">
                    <h1>üìä Â∑•‰∫∫ÁÆ°ÁêÜÁ≥ªÁªü</h1>
                    <div id="current-time" style="color: #7f8c8d; margin-top: 5px;"></div>
                </div>
                <div class="header-actions">
                    <button class="btn" onclick="addAccount()">
                        ‚ûï Ê∑ªÂä†Ë¥¶Âè∑
                    </button>
                </div>
            </div>
            <div class="version-info">
                <span class="version-badge">v1.3</span>
                <span class="author-info">‰ΩúËÄÖÔºöË∑ØÈÅ•</span>
            </div>
        </div>

        <!-- ÂÖ®Â±ÄÂÆûÊó∂Âä®ÊÄÅÈù¢Êùø -->
        <div class="global-upcoming">
            <h2>
                ‚ö° ÂÆûÊó∂Âä®ÊÄÅÈù¢Êùø 
                <span class="realtime-indicator">LIVE</span>
            </h2>
            <div class="task-progress-table">
                <div class="task-progress-header">
                    <div>Ë¥¶Âè∑</div>
                    <div>Ââ©‰ΩôÊó∂Èó¥</div>
                </div>
                <div id="global-task-list">
                    <!-- Âä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
        </div>

        <!-- Ê±áÊÄªÈù¢Êùø -->
        <div class="summary">
            <h2>üìà Ë¥¶Âè∑ÊÄªËßà</h2>
            <div class="summary-grid" id="summary-grid">
                <!-- Âä®ÊÄÅÁîüÊàê -->
            </div>
        </div>

        <!-- Ë¥¶Âè∑ËØ¶ÊÉÖ -->
        <div id="accounts-details">
            <!-- Âä®ÊÄÅÁîüÊàê -->
        </div>
    </div>

    <!-- ‰ªªÂä°ÂàÜÈÖçÊ®°ÊÄÅÊ°Ü -->
    <div class="modal hidden" id="task-modal">
        <div class="modal-content">
            <h3 id="modal-title">ÂàÜÈÖç‰ªªÂä°</h3>
            <div class="form-group">
                <label>‰ªªÂä°Êó∂Èïø</label>
                <div class="form-row">
                    <div>
                        <label style="font-size: 12px; color: #7f8c8d;">Â§©Êï∞</label>
                        <input type="number" class="form-input" id="task-days" value="0" min="0">
                    </div>
                    <div>
                        <label style="font-size: 12px; color: #7f8c8d;">Â∞èÊó∂Êï∞</label>
                        <input type="number" class="form-input" id="task-hours" value="1" min="1" max="23">
                    </div>
                </div>
                <div style="margin-top: 10px; font-size: 14px; color: #7f8c8d;" id="total-time">
                    ÊÄªÊó∂Èïø: 0Â§©1Â∞èÊó∂
                </div>
            </div>
            <div class="form-actions">
                <button class="btn btn-success" onclick="assignTask()">ÂàÜÈÖç‰ªªÂä°</button>
                <button class="btn btn-secondary" onclick="closeModal()">ÂèñÊ∂à</button>
            </div>
        </div>
    </div>

    <!-- Âà†Èô§Á°ÆËÆ§Ê®°ÊÄÅÊ°Ü -->
    <div class="modal hidden" id="delete-modal">
        <div class="modal-content">
            <h3>üóëÔ∏è Âà†Èô§Ë¥¶Âè∑</h3>
            <p style="margin-bottom: 20px; color: #7f8c8d;">
                Á°ÆÂÆöË¶ÅÂà†Èô§ "<strong id="delete-account-name"></strong>" ÂêóÔºü<br>
                Ê≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄÔºåÊâÄÊúâÁõ∏ÂÖ≥‰ªªÂä°Â∞ÜË¢´Ê∏ÖÈô§„ÄÇ
            </p>
            <div class="form-actions">
                <button class="btn btn-danger" onclick="confirmDelete()">Á°ÆËÆ§Âà†Èô§</button>
                <button class="btn btn-secondary" onclick="closeDeleteModal()">ÂèñÊ∂à</button>
            </div>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let accounts = [];
        let currentTime = new Date();
        let selectedAccount = null;
        let taskType = 'worker';
        let editingAccountId = null;
        let deleteAccountId = null;
        let expandedAccounts = new Set(); // ËÆ∞ÂΩïÂ±ïÂºÄÁöÑË¥¶Âè∑

        // ÂàùÂßãÂåñ
        function init() {
            loadData();
            updateTime();
            setInterval(updateTime, 1000);
            setInterval(checkTasks, 1000);
            
            // ÁªëÂÆöËæìÂÖ•‰∫ã‰ª∂
            document.getElementById('task-days').addEventListener('input', updateTotalTime);
            document.getElementById('task-hours').addEventListener('input', updateTotalTime);
        }

        // Âä†ËΩΩÊï∞ÊçÆ
        function loadData() {
            try {
                const saved = localStorage.getItem('workerProgressData');
                if (saved) {
                    accounts = JSON.parse(saved).map(account => ({
                        ...account,
                        workers: account.workers.map(worker => ({
                            ...worker,
                            isVacation: worker.isVacation || false,
                            endTime: worker.endTime ? new Date(worker.endTime) : null
                        })),
                        scholars: account.scholars.map(scholar => ({
                            ...scholar,
                            isVacation: scholar.isVacation || false,
                            endTime: scholar.endTime ? new Date(scholar.endTime) : null
                        }))
                    }));
                } else {
                    // ÂàõÂª∫ÈªòËÆ§Ë¥¶Âè∑
                    accounts = [
                        { id: 1, name: 'Ë¥¶Âè∑ 1' },
                        { id: 2, name: 'Ë¥¶Âè∑ 2' },
                        { id: 3, name: 'Ë¥¶Âè∑ 3' }
                    ].map(acc => ({
                        ...acc,
                        workers: Array.from({ length: 6 }, (_, i) => ({
                            id: i + 1,
                            isWorking: false,
                            isVacation: false,
                            taskName: '',
                            endTime: null
                        })),
                        scholars: [{
                            id: 1,
                            isWorking: false,
                            isVacation: false,
                            taskName: '',
                            endTime: null
                        }]
                    }));
                }
                render();
            } catch (error) {
                console.error('Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•:', error);
                accounts = [];
                render();
            }
        }

        // ‰øùÂ≠òÊï∞ÊçÆ
        function saveData() {
            try {
                localStorage.setItem('workerProgressData', JSON.stringify(accounts));
            } catch (error) {
                console.error('‰øùÂ≠òÊï∞ÊçÆÂ§±Ë¥•:', error);
            }
        }

        // Êõ¥Êñ∞Êó∂Èó¥
        function updateTime() {
            currentTime = new Date();
            document.getElementById('current-time').textContent = 
                `ÂΩìÂâçÊó∂Èó¥: ${currentTime.toLocaleString('zh-CN')}`;
        }

        // Ê£ÄÊü•‰ªªÂä°Áä∂ÊÄÅ
        function checkTasks() {
            let updated = false;
            const now = new Date();
            
            accounts.forEach(account => {
                account.workers.forEach(worker => {
                    if (worker.isWorking && worker.endTime && now >= worker.endTime) {
                        worker.isWorking = false;
                        worker.taskName = '';
                        worker.endTime = null;
                        updated = true;
                    }
                });
                
                account.scholars.forEach(scholar => {
                    if (scholar.isWorking && scholar.endTime && now >= scholar.endTime) {
                        scholar.isWorking = false;
                        scholar.taskName = '';
                        scholar.endTime = null;
                        updated = true;
                    }
                });
            });
            
            if (updated) {
                render();
                saveData();
            }
        }

        // Ê∑ªÂä†Ë¥¶Âè∑
        function addAccount() {
            const newId = Math.max(...accounts.map(a => a.id), 0) + 1;
            const newAccount = {
                id: newId,
                name: `Ë¥¶Âè∑ ${newId}`,
                workers: Array.from({ length: 6 }, (_, i) => ({
                    id: i + 1,
                    isWorking: false,
                    isVacation: false,
                    taskName: '',
                    endTime: null
                })),
                scholars: [{
                    id: 1,
                    isWorking: false,
                    isVacation: false,
                    taskName: '',
                    endTime: null
                }]
            };
            accounts.push(newAccount);
            render();
            saveData();
        }

        // Âà†Èô§Ë¥¶Âè∑
        function deleteAccount(accountId) {
            deleteAccountId = accountId;
            const account = accounts.find(a => a.id === accountId);
            document.getElementById('delete-account-name').textContent = account.name;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function confirmDelete() {
            accounts = accounts.filter(a => a.id !== deleteAccountId);
            expandedAccounts.delete(deleteAccountId);
            closeDeleteModal();
            render();
            saveData();
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            deleteAccountId = null;
        }

        // ÁºñËæëË¥¶Âè∑ÂêçÁß∞
        function editAccountName(accountId) {
            editingAccountId = accountId;
            render();
        }

        function saveAccountName(accountId, newName) {
            if (newName.trim()) {
                const account = accounts.find(a => a.id === accountId);
                if (account) {
                    account.name = newName.trim();
                }
            }
            editingAccountId = null;
            render();
            saveData();
        }

        function cancelEdit() {
            editingAccountId = null;
            render();
        }

        // Â±ïÂºÄ/ÊäòÂè†Ë¥¶Âè∑ËØ¶ÊÉÖ
        function toggleAccountDetail(accountId) {
            if (expandedAccounts.has(accountId)) {
                expandedAccounts.delete(accountId);
            } else {
                expandedAccounts.add(accountId);
            }
            render();
        }

        // ‰ªªÂä°ÁÆ°ÁêÜ
        function openTaskModal(account, type) {
            selectedAccount = account;
            taskType = type;
            document.getElementById('modal-title').textContent = 
                `ÂàÜÈÖç${type === 'worker' ? 'Â∑•‰∫∫' : 'Â≠¶ËÄÖ'}‰ªªÂä° - ${account.name}`;
            document.getElementById('task-modal').classList.remove('hidden');
            updateTotalTime();
        }

        function closeModal() {
            document.getElementById('task-modal').classList.add('hidden');
            selectedAccount = null;
        }

        function updateTotalTime() {
            const days = parseInt(document.getElementById('task-days').value) || 0;
            const hours = parseInt(document.getElementById('task-hours').value) || 1;
            document.getElementById('total-time').textContent = `ÊÄªÊó∂Èïø: ${days}Â§©${hours}Â∞èÊó∂`;
        }

        function assignTask() {
            if (!selectedAccount) return;
            
            const days = parseInt(document.getElementById('task-days').value) || 0;
            const hours = parseInt(document.getElementById('task-hours').value) || 1;
            const totalMs = (days * 24 * 60 * 60 * 1000) + (hours * 60 * 60 * 1000);
            const endTime = new Date(Date.now() + totalMs);
            const taskName = `‰ªªÂä° ${days}Â§©${hours}Â∞èÊó∂`;

            const account = accounts.find(a => a.id === selectedAccount.id);
            if (!account) return;

            if (taskType === 'worker') {
                const availableWorker = account.workers.find(w => !w.isWorking && !w.isVacation);
                if (availableWorker) {
                    availableWorker.isWorking = true;
                    availableWorker.taskName = taskName;
                    availableWorker.endTime = endTime;
                }
            } else {
                const scholar = account.scholars[0];
                if (!scholar.isWorking && !scholar.isVacation) {
                    scholar.isWorking = true;
                    scholar.taskName = taskName;
                    scholar.endTime = endTime;
                }
            }

            closeModal();
            render();
            saveData();
        }

        // ÈáäÊîæÂ∑•‰∫∫/Â≠¶ËÄÖ
        function releaseWorker(accountId, type, workerId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) return;

            if (type === 'worker') {
                const worker = account.workers.find(w => w.id === workerId);
                if (worker) {
                    worker.isWorking = false;
                    worker.taskName = '';
                    worker.endTime = null;
                }
            } else {
                const scholar = account.scholars[0];
                scholar.isWorking = false;
                scholar.taskName = '';
                scholar.endTime = null;
            }

            render();
            saveData();
        }

        // ÊîæÂÅá/ÂºÄÂ∑•ÂäüËÉΩ
        function toggleVacation(accountId, workerType, workerId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) return;

            let worker;
            if (workerType === 'worker') {
                worker = account.workers.find(w => w.id === workerId);
            } else {
                worker = account.scholars[0];
            }
            
            if (!worker) return;

            // Â¶ÇÊûúÊ≠£Âú®Â∑•‰ΩúÔºåÂÖàÈáäÊîæ‰ªªÂä°
            if (worker.isWorking) {
                worker.isWorking = false;
                worker.taskName = '';
                worker.endTime = null;
            }

            // ÂàáÊç¢ÊîæÂÅáÁä∂ÊÄÅ
            worker.isVacation = !worker.isVacation;

            render();
            saveData();
        }

        // Ëé∑ÂèñÂÆûÊó∂Âä®ÊÄÅÊï∞ÊçÆÔºàÁ©∫Èó≤Â∑•‰∫∫/Â≠¶ËÄÖ + Âç≥Â∞ÜÂÆåÊàê‰ªªÂä°Ôºâ
        function getRealTimeData() {
            const availableWorkers = [];
            const completingTasks = [];
            
            accounts.forEach(account => {
                // Ëé∑ÂèñÁ©∫Èó≤Â∑•‰∫∫
                account.workers.forEach(worker => {
                    if (!worker.isWorking && !worker.isVacation) {
                        availableWorkers.push({
                            account: account.name,
                            accountId: account.id,
                            name: `Â∑•‰∫∫${worker.id}`,
                            workerId: worker.id,
                            type: 'worker',
                            status: 'available'
                        });
                    }
                });
                
                // Ëé∑ÂèñÁ©∫Èó≤Â≠¶ËÄÖ
                account.scholars.forEach(scholar => {
                    if (!scholar.isWorking && !scholar.isVacation) {
                        availableWorkers.push({
                            account: account.name,
                            accountId: account.id,
                            name: 'Â≠¶ËÄÖ1',
                            workerId: 1,
                            type: 'scholar',
                            status: 'available'
                        });
                    }
                });
                
                // Ëé∑ÂèñÂç≥Â∞ÜÂÆåÊàêÁöÑ‰ªªÂä°
                account.workers.forEach(worker => {
                    if (worker.isWorking && worker.endTime && !worker.isVacation) {
                        completingTasks.push({
                            account: account.name,
                            accountId: account.id,
                            name: `Â∑•‰∫∫${worker.id}`,
                            workerId: worker.id,
                            taskName: worker.taskName,
                            endTime: worker.endTime,
                            type: 'worker'
                        });
                    }
                });
                
                account.scholars.forEach(scholar => {
                    if (scholar.isWorking && scholar.endTime && !scholar.isVacation) {
                        completingTasks.push({
                            account: account.name,
                            accountId: account.id,
                            name: 'Â≠¶ËÄÖ1',
                            workerId: 1,
                            taskName: scholar.taskName,
                            endTime: scholar.endTime,
                            type: 'scholar'
                        });
                    }
                });
            });
            
            // ÊåâÁªìÊùüÊó∂Èó¥ÊéíÂ∫èÂç≥Â∞ÜÂÆåÊàêÁöÑ‰ªªÂä°ÔºåÂèñÂâç3‰∏™
            completingTasks.sort((a, b) => a.endTime - b.endTime);
            
            return {
                availableWorkers,
                completingTasks: completingTasks.slice(0, 3)
            };
        }

        // Ëé∑ÂèñËøõÂ∫¶Êù°È¢úËâ≤ÂíåËøõÂ∫¶
        function getProgressInfo(endTime) {
            if (!endTime) return { color: 'green', progress: 0 };
            
            const now = new Date();
            const remaining = endTime - now;
            const hours = remaining / (1000 * 60 * 60);
            
            let color = 'green';
            if (hours > 24) {
                color = 'red';
            } else if (hours > 8) {
                color = 'orange';
            }
            
            // ÁÆÄÂåñËøõÂ∫¶ËÆ°ÁÆó
            const progress = Math.max(0, Math.min(100, (1 - hours / 24) * 100));
            
            return { color, progress };
        }

        // ÂØºÂÖ•ÂØºÂá∫ÂäüËÉΩ
        function exportConfig() {
            try {
                const config = {
                    version: "1.2",
                    author: "Ë∑ØÈÅ•",
                    exportTime: new Date().toISOString(),
                    accounts: accounts
                };
                
                const dataStr = JSON.stringify(config, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `Â∑•‰∫∫ËøõÂ∫¶ÈÖçÁΩÆ_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                alert('‚úÖ ÈÖçÁΩÆÊñá‰ª∂ÂØºÂá∫ÊàêÂäüÔºÅ');
            } catch (error) {
                console.error('ÂØºÂá∫Â§±Ë¥•:', error);
                alert('‚ùå ÂØºÂá∫Â§±Ë¥•ÔºåËØ∑ÈáçËØï');
            }
        }

        function importConfig(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const config = JSON.parse(e.target.result);
                    
                    // È™åËØÅÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè
                    if (!config.accounts || !Array.isArray(config.accounts)) {
                        throw new Error('ÈÖçÁΩÆÊñá‰ª∂Ê†ºÂºè‰∏çÊ≠£Á°Æ');
                    }
                    
                    // È™åËØÅÂπ∂Ë°•ÂÖÖÁº∫Â§±ÁöÑÂ≠óÊÆµ
                    const validatedAccounts = config.accounts.map(account => ({
                        id: account.id || Date.now() + Math.random(),
                        name: account.name || 'Êú™ÂëΩÂêçË¥¶Âè∑',
                        workers: (account.workers || []).map((worker, index) => ({
                            id: worker.id || (index + 1),
                            isWorking: worker.isWorking || false,
                            isVacation: worker.isVacation || false,
                            taskName: worker.taskName || '',
                            endTime: worker.endTime ? new Date(worker.endTime) : null
                        })),
                        scholars: (account.scholars || []).map((scholar, index) => ({
                            id: scholar.id || 1,
                            isWorking: scholar.isWorking || false,
                            isVacation: scholar.isVacation || false,
                            taskName: scholar.taskName || '',
                            endTime: scholar.endTime ? new Date(scholar.endTime) : null
                        }))
                    }));
                    
                    // Á°Æ‰øùÊØè‰∏™Ë¥¶Âè∑ÈÉΩÊúâ6‰∏™Â∑•‰∫∫Âíå1‰∏™Â≠¶ËÄÖ
                    validatedAccounts.forEach(account => {
                        // Ë°•ÂÖÖÂ∑•‰∫∫Ëá≥6‰∏™
                        while (account.workers.length < 6) {
                            account.workers.push({
                                id: account.workers.length + 1,
                                isWorking: false,
                                isVacation: false,
                                taskName: '',
                                endTime: null
                            });
                        }
                        
                        // Á°Æ‰øùÊúâ1‰∏™Â≠¶ËÄÖ
                        if (account.scholars.length === 0) {
                            account.scholars.push({
                                id: 1,
                                isWorking: false,
                                isVacation: false,
                                taskName: '',
                                endTime: null
                            });
                        }
                    });
                    
                    // Á°ÆËÆ§ÂØºÂÖ•
                    const confirmMsg = `Á°ÆÂÆöË¶ÅÂØºÂÖ•ÈÖçÁΩÆÂêóÔºü\n\nÊñá‰ª∂‰ø°ÊÅØÔºö\n- Ë¥¶Âè∑Êï∞ÈáèÔºö${validatedAccounts.length}\n- ÂØºÂá∫Êó∂Èó¥Ôºö${config.exportTime ? new Date(config.exportTime).toLocaleString('zh-CN') : 'Êú™Áü•'}\n- ÁâàÊú¨Ôºö${config.version || 'Êú™Áü•'}\n\n‚ö†Ô∏è ÂΩìÂâçÊï∞ÊçÆÂ∞ÜË¢´Ë¶ÜÁõñÔºÅ`;
                    
                    if (confirm(confirmMsg)) {
                        accounts = validatedAccounts;
                        expandedAccounts.clear();
                        render();
                        saveData();
                        alert('‚úÖ ÈÖçÁΩÆÂØºÂÖ•ÊàêÂäüÔºÅ');
                    }
                    
                } catch (error) {
                    console.error('ÂØºÂÖ•Â§±Ë¥•:', error);
                    alert(`‚ùå ÂØºÂÖ•Â§±Ë¥•Ôºö${error.message}\n\nËØ∑Ê£ÄÊü•Êñá‰ª∂Ê†ºÂºèÊòØÂê¶Ê≠£Á°Æ`);
                }
                
                // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•
                event.target.value = '';
            };
            
            reader.onerror = function() {
                alert('‚ùå Êñá‰ª∂ËØªÂèñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }

        // Â∑•ÂÖ∑ÂáΩÊï∞
        function formatTimeRemaining(endTime) {
            if (!endTime) return '';
            const now = new Date();
            const diff = endTime - now;
            if (diff <= 0) return 'Â∑≤ÂÆåÊàê';
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            let result = '';
            if (days > 0) {
                result += `${days}d`;
            }
            if (hours > 0) {
                result += `${hours}h`;
            }
            if (minutes > 0 || result === '') {
                result += `${minutes}m`;
            }
            
            return result;
        }

        function getAvailableCount(account, type) {
            if (type === 'worker') {
                const available = account.workers.filter(w => !w.isWorking && !w.isVacation).length;
                return `${available}/6`;
            } else {
                const available = account.scholars.filter(s => !s.isWorking && !s.isVacation).length;
                return `${available}/1`;
            }
        }

        // Ê∏≤ÊüìÁïåÈù¢
        function render() {
            renderGlobalUpcoming();
            renderSummary();
            renderAccountDetails();
        }

        function renderGlobalUpcoming() {
            const globalTaskList = document.getElementById('global-task-list');
            const realTimeData = getRealTimeData();
            
            if (realTimeData.availableWorkers.length === 0 && realTimeData.completingTasks.length === 0) {
                globalTaskList.innerHTML = '<div class="no-tasks-message">ÊöÇÊó†Á©∫Èó≤Â∑•‰∫∫/Â≠¶ËÄÖÔºå‰πüÊó†ËøõË°å‰∏≠ÁöÑ‰ªªÂä°</div>';
                return;
            }
            
            let html = '';
            
            // È¶ñÂÖàÊòæÁ§∫Á©∫Èó≤ÁöÑÂ∑•‰∫∫/Â≠¶ËÄÖÔºàÁΩÆÈ°∂È´ò‰∫ÆÔºâ
            if (realTimeData.availableWorkers.length > 0) {
                html += realTimeData.availableWorkers.map(worker => `
                    <div class="task-progress-row available-highlight" onclick="openTaskModal(${JSON.stringify(accounts.find(a => a.id === worker.accountId)).replace(/"/g, '&quot;')}, '${worker.type}')" title="ÁÇπÂáªÂàÜÈÖç‰ªªÂä°">
                        <div class="task-account">${worker.account} - ${worker.name}</div>
                        <div style="text-align: center;">
                            <button class="assign-task-btn" onclick="event.stopPropagation(); openTaskModal(${JSON.stringify(accounts.find(a => a.id === worker.accountId)).replace(/"/g, '&quot;')}, '${worker.type}')">
                                ÂàÜÈÖç‰ªªÂä°
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            // ÁÑ∂ÂêéÊòæÁ§∫Âç≥Â∞ÜÂÆåÊàêÁöÑ‰ªªÂä°ÔºàÊúÄÂ§ö3Êù°Ôºâ- ÂéªÊéâÂ∑•‰∫∫/Â≠¶ËÄÖÊòæÁ§∫ÂíåÈáäÊîæÊåâÈíÆ
            if (realTimeData.completingTasks.length > 0) {
                html += realTimeData.completingTasks.map(task => {
                    const remaining = task.endTime - new Date();
                    const hours = remaining / (1000 * 60 * 60);
                    
                    let timeClass = 'normal';
                    if (hours < 1) {
                        timeClass = 'urgent';
                    } else if (hours < 6) {
                        timeClass = 'warning';
                    }
                    
                    return `
                        <div class="task-progress-row completing-task" onclick="releaseWorker(${task.accountId}, '${task.type}', ${task.workerId})" title="ÁÇπÂáªÈáäÊîæ‰ªªÂä°">
                            <div class="task-account">${task.account}</div>
                            <div class="task-time-cell ${timeClass}">${formatTimeRemaining(task.endTime)}</div>
                        </div>
                    `;
                }).join('');
            }
            
            globalTaskList.innerHTML = html;
        }

        function renderSummary() {
            const summaryGrid = document.getElementById('summary-grid');
            summaryGrid.innerHTML = accounts.map(account => {
                const availableWorkers = account.workers.filter(w => !w.isWorking && !w.isVacation).length;
                const availableScholars = account.scholars.filter(s => !s.isWorking && !s.isVacation).length;
                
                // Âà§Êñ≠Ë¥¶Âè∑Áä∂ÊÄÅÔºöÊúâÁ©∫Èó≤ËµÑÊ∫ê‰∏∫ÂèØÁî®ÔºåÂê¶Âàô‰∏∫ÂøôÁ¢å
                const hasAvailable = availableWorkers > 0 || availableScholars > 0;
                const statusClass = hasAvailable ? 'available' : 'busy';
                const statusDot = hasAvailable ? 'available' : 'busy';
                
                return `
                <div class="summary-card ${statusClass}" onclick="toggleAccountDetail(${account.id})">
                    <h3>
                        ${editingAccountId === account.id ? `
                            <input type="text" class="edit-input" value="${account.name}" 
                                   onkeypress="if(event.key==='Enter') saveAccountName(${account.id}, this.value)"
                                   onblur="saveAccountName(${account.id}, this.value)" 
                                   onfocus="this.select()" 
                                   onclick="event.stopPropagation()" />
                        ` : `
                            <span class="account-status-dot ${statusDot}"></span>
                            <span>${account.name}</span>
                        `}
                    </h3>
                    ${editingAccountId !== account.id ? `
                        <div style="position: absolute; top: 10px; right: 10px; opacity: 0; transition: opacity 0.3s;" 
                             onmouseenter="this.style.opacity='1'" 
                             onmouseleave="this.style.opacity='0'">
                            <button class="btn btn-mini" onclick="event.stopPropagation(); editAccountName(${account.id})" title="ÁºñËæë">‚úèÔ∏è</button>
                            <button class="btn btn-mini btn-danger" onclick="event.stopPropagation(); deleteAccount(${account.id})" title="Âà†Èô§">üóëÔ∏è</button>
                        </div>
                    ` : ''}
                </div>
            `}).join('');
        }

        function renderAccountDetails() {
            const accountsDetails = document.getElementById('accounts-details');
            accountsDetails.innerHTML = accounts.map(account => {
                const isExpanded = expandedAccounts.has(account.id);
                
                if (!isExpanded) return '';
                
                const sortedWorkers = [...account.workers].sort((a, b) => {
                    // Ê≠£Âú®Â∑•‰ΩúÁöÑÂ∑•‰∫∫‰ºòÂÖàÔºåÊåâÂâ©‰ΩôÊó∂Èó¥ÊéíÂ∫è
                    if (a.isWorking && b.isWorking) {
                        return a.endTime - b.endTime;
                    }
                    // Ê≠£Âú®Â∑•‰ΩúÁöÑÂú®ÂâçÔºåÁ©∫Èó≤ÁöÑÂú®Âêé
                    if (a.isWorking && !b.isWorking) return -1;
                    if (!a.isWorking && b.isWorking) return 1;
                    // ÈÉΩÁ©∫Èó≤Êó∂ÊåâIDÊéíÂ∫è
                    return a.id - b.id;
                });
                
                return `
                <div class="account-detail">
                    <div class="account-detail-header" onclick="toggleAccountDetail(${account.id})">
                        <div class="account-detail-title">${account.name} - ËØ¶ÁªÜ‰ø°ÊÅØ</div>
                        <div>‚ñ≤ Êî∂Ëµ∑</div>
                    </div>
                    <div class="account-detail-content">
                        <div class="workers-section">
                            <div class="section-title">üë∑ Â∑•‰∫∫ (${getAvailableCount(account, 'worker')}) 
                                <span style="font-size: 0.8em; color: #95a5a6; font-weight: normal;">- ÊåâÂÆåÊàêÊó∂Èó¥ÊéíÂ∫è</span>
                            </div>
                            <div class="workers-grid">
                                ${sortedWorkers.map(worker => {
                                    const progressInfo = getProgressInfo(worker.endTime);
                                    let cardClass = 'available';
                                    if (worker.isVacation) {
                                        cardClass = 'vacation';
                                    } else if (worker.isWorking) {
                                        cardClass = 'working';
                                    }
                                    
                                    return `
                                    <div class="worker-card ${cardClass}">
                                        <div class="worker-header">
                                            <div class="worker-name">Â∑•‰∫∫ ${worker.id}</div>
                                            <div style="display: flex; gap: 5px;">
                                                ${worker.isWorking ? `
                                                    <button class="release-btn" onclick="releaseWorker(${account.id}, 'worker', ${worker.id})">
                                                        ‚ûñ
                                                    </button>
                                                ` : ''}
                                                ${worker.isVacation ? `
                                                    <button class="work-btn" onclick="toggleVacation(${account.id}, 'worker', ${worker.id})" title="ÂºÄÂ∑•">
                                                        üîÑ
                                                    </button>
                                                ` : `
                                                    <button class="vacation-btn" onclick="toggleVacation(${account.id}, 'worker', ${worker.id})" title="ÊîæÂÅá">
                                                        üò¥
                                                    </button>
                                                `}
                                            </div>
                                        </div>
                                        ${worker.isVacation ? `
                                            <div class="worker-info">
                                                <div style="color: #95a5a6; font-style: italic;">üò¥ ÊîæÂÅá‰∏≠</div>
                                            </div>
                                        ` : worker.isWorking ? `
                                            <div class="worker-info">
                                                <div>${worker.taskName}</div>
                                                <div class="worker-progress">
                                                    <div class="progress-bar ${progressInfo.color}" style="width: ${progressInfo.progress}%"></div>
                                                </div>
                                                <div>‚è∞ ${formatTimeRemaining(worker.endTime)}</div>
                                            </div>
                                        ` : ''}
                                    </div>
                                `}).join('')}
                            </div>
                        </div>
                        
                        <div class="workers-section">
                            <div class="section-title">üéì Â≠¶ËÄÖ (${getAvailableCount(account, 'scholar')})</div>
                            <div class="worker-card ${account.scholars[0].isVacation ? 'vacation' : (account.scholars[0].isWorking ? 'working' : 'available')}">
                                <div class="worker-header">
                                    <div class="worker-name">Â≠¶ËÄÖ 1</div>
                                    <div style="display: flex; gap: 5px;">
                                        ${account.scholars[0].isWorking ? `
                                            <button class="release-btn" onclick="releaseWorker(${account.id}, 'scholar', 1)">
                                                ‚ûñ
                                            </button>
                                        ` : ''}
                                        ${account.scholars[0].isVacation ? `
                                            <button class="work-btn" onclick="toggleVacation(${account.id}, 'scholar', 1)" title="ÂºÄÂ∑•">
                                                üîÑ
                                            </button>
                                        ` : `
                                            <button class="vacation-btn" onclick="toggleVacation(${account.id}, 'scholar', 1)" title="ÊîæÂÅá">
                                                üò¥
                                            </button>
                                        `}
                                    </div>
                                </div>
                                ${account.scholars[0].isVacation ? `
                                    <div class="worker-info">
                                        <div style="color: #95a5a6; font-style: italic;">üò¥ ÊîæÂÅá‰∏≠</div>
                                    </div>
                                ` : account.scholars[0].isWorking ? `
                                    <div class="worker-info">
                                        <div>${account.scholars[0].taskName}</div>
                                        <div class="worker-progress">
                                            <div class="progress-bar ${getProgressInfo(account.scholars[0].endTime).color}" style="width: ${getProgressInfo(account.scholars[0].endTime).progress}%"></div>
                                        </div>
                                        <div>‚è∞ ${formatTimeRemaining(account.scholars[0].endTime)}</div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>